<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Writeups | Vasilis&#39; Security Notes</title>
<meta name="keywords" content="">
<meta name="description" content="Writeups - Vasilis&#39; Security Notes">
<meta name="author" content="Vasilis">
<link rel="canonical" href="http://localhost:1313/writeups/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.36819bea596090d8b48cf10d9831382996197aa7e4fc86f792f7c08c9ca4d23b.css" integrity="sha256-NoGb6llgkNi0jPENmDE4KZYZeqfk/Ib3kvfAjJyk0js=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/writeups/index.xml">
<link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Vasilis&#39; Security Notes (Alt + H)">Vasilis&#39; Security Notes</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/research/" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/writeups/" title="Writeups">
                    <span class="active">Writeups</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    Writeups
  </h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Buffer overflow writeup
    </h2>
  </header>
  <div class="entry-content">
    <p>1. Overview of the Vulnerability When readelf processes the .comment section of an ELF, it enters a loop that copies bytes from that section into a fixed‐size, 128‐byte stack buffer named comment[]. Internally, the code looks roughly like this:
#define MAX_COMMENT 128 char comment[MAX_COMMENT]; int version_start = 0, idx = 0; char c; /* xsh_offset points to the file‐offset of .comment’s data */ while (pread(fd, &amp;c, 1, xsh_offset &#43; idx) == 1) { if (c == &#39;(&#39;) { version_start = idx &#43; 1; } else if (c == &#39;)&#39;) { break; } else if (version_start != 0) { /* UNBOUNDED WRITE: */ comment[idx - version_start] = c; } idx&#43;&#43;; } comment[idx - version_start] = &#39;\0&#39;; file_printf(ms, &#34;, os/compiler version =&gt; [%s]&#34;, comment); comment is 128 bytes long, stored at RBP - 0xF0 through RBP - 0x70 on x86-64. Whenever the code sees a &#39;(&#39;, it sets version_start = idx &#43; 1. From that point on, each subsequent byte (up until a &#39;)&#39;) is written to comment[idx - version_start]. There is no bounds check on idx - version_start, so once that expression exceeds 127, writes begin overflowing into adjacent stack memory (locals, saved-RBP, then saved-RIP). As soon as a &#39;)&#39; is read, the loop breaks and writes a NUL at comment[idx - version_start]. By carefully choosing where two &#39;(&#39; characters appear in the input, we can control exactly when the code starts writing to comment[0] and then intentionally overflow beyond offset 127 to overwrite saved-RIP. When doshn eventually returns, it will pop our crafted return address from the stack.
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-06-30 00:00:00 +0000 UTC'>June 30, 2025</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Vasilis</footer>
  <a class="entry-link" aria-label="post link to Buffer overflow writeup" href="http://localhost:1313/writeups/buffer-overflow/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">RPC Calculator Vulnerability Writeup
    </h2>
  </header>
  <div class="entry-content">
    <p> Executive Summary This report identifies and analyzes vulnerabilities found in a socket-based and RPC-powered calculator program implemented in C. The system includes three components:
client.c calc_client.c (server-side RPC caller) calc_server.c (RPC service implementation) While the project functions as intended for vector calculations, it lacks critical input validation, secure communication, and safe memory handling. The vulnerabilities are categorized by severity and accompanied by suggested mitigations.
Vulnerability Summary Table ID Component Issue Severity Risk Description V1 client.c Unchecked return values from scanf Medium May lead to undefined behavior V2 client.c No lower bound check for vector length Medium Could allow negative indexing or zero-size V3 client.c No validation of recv() output Medium Memory corruption or logic flaws V4 client.c Unencrypted socket communication High Vulnerable to MITM attacks V5 calc_server.c Static memory reuse in avg/prod Medium May cause data races or memory leaks V6 calc_server.c No sanity limit on vector size Medium Integer overflow or DoS V7 calc_client.c Unvalidated read() calls High Incomplete or corrupted input data V8 calc_client.c No bounds check on vector size Medium Same as V2, but in server V9 calc_client.c Static results not freed in prod_r_1 Low Memory management issue (minor leak) V10 calc_client.c Missing signal handling Low Zombie processes due to unhandled SIGCHLD Detailed Vulnerabilities and Mitigations client.c V1. Unchecked scanf Return Values
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-06-30 00:00:00 +0000 UTC'>June 30, 2025</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Vasilis</footer>
  <a class="entry-link" aria-label="post link to RPC Calculator Vulnerability Writeup" href="http://localhost:1313/writeups/rpc-calc-writeup/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Vasilis&#39; Security Notes</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
